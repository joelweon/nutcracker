<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>로그인</title>
</head>
<body>

<div id='header' style='background-color:gray; height:40px;position:relative;'></div>

<div id='sidebar' style='background-color:Navy; width:180px; height:400px;'></div>

<div id="content">
<h1>로그인</h1>

<form action='login.do' method='POST'>
<table border='1'>
<tr><th>이메일</th><td><input name='email' type='text' placeholder='예)hong@test.com' value='${cookie.email.value}'></td></tr>
<tr><th>암호</th><td><input name='password' type='password'></td></tr>
<tr><th></th><td><input name='saveEmail' type='checkbox'> 이메일 저장</td></tr>
</table>
<button type='submit'>로그인</button>
</form>
</div>

<div id='footer' style='background-color:gray; height:20px; margin-top:20px;'></div>

<script src="../js/bit.js"></script>
<script src="../js/common.js"></script>
<script>
document.querySelector('#login-btn').onclick = function() {
  // 이메일 저장이 체크되어 있으면 쿠키에 저장하고, 
  // 체크되어 있지 않으면 쿠키에서 제거한다.
  if (document.querySelector('#save-email').checked) {
    setCookie('email', document.querySelector('#email').value, 30);
  } else {
    setCookie('email', '', 0);
  }
  
  var param = {
    email: document.querySelector('#email').value,
    password: document.querySelector('#password').value
  };
  
  post('login.json', param, function(jsonText) {
    var ajaxResult = JSON.parse(jsonText);
    
    if (ajaxResult.status == "success") {
      location.href = "../member/main.html"; 
      return;
    }
    
    alert(ajaxResult.data);
    
  });
}
// email 쿠키가 있다면 값을 넣는다.
document.querySelector('#email').value = getCookie('email').replace(/"/g, '');
</script>

</body>
</html>